name: Ophidian Publish
description: Publish Ophidian-based Plugin with PNPM

branding:
  icon: aperture
  color: purple

inputs:
  token:
    description: Github Token (for release publishing)
    required: true
  release-notes:
    description: Markdown for release notes (e.g. github.event.commits[0].message)
    required: true

runs:
  using: composite

  steps:
    - uses: actions/setup-node@v1
      with:
        node-version: "14.x"
    - uses: pnpm/action-setup@v2.2.2
      with:
        version: 6.32.19
    - name: Create release and Upload
      id: release
      shell: bash
      env:
        GITHUB_TOKEN: ${{ inputs.token }}
        COMMIT_MESSAGE: ${{ inputs.release-notes }}
      run: |
        "$GITHUB_ACTION_PATH"/publish-plugin.sh
